<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />
  <title>Ejercicio Arrays Completado</title>
</head>

<body>
  <br />
  <h2>Ejercicio Arrays</h2>
  <p>
    Array X
    <input type="text" size="60" name="caja1" value="X1,X2,X3,X4,X5" />
  </p>
  <p>
    Array Z
    <input type="text" size="60" name="caja2" value="Z1,Z2,Z3,Z4,Z5" />
  </p>
  <p>
    Array Y
    <input type="text" size="60" name="caja3" value="Y1,Y2,Y3,Y4,Y5" />
  </p>

  <p>
    <input type="button" name="button" value="Add Array (Intercalado)" onclick="concatenaArrays2();" />
    <input type="button" name="button3" value="Add Array (Concat)" onclick="concatenaArrays3();" />
  </p>
  <p>
    <input type="button" name="button2" value="Limpiar / Reset" onclick="eliminarArra();" />
  </p>
  <p>
    <input type="button" name="button2" value="Sort (Ordenar)" onclick="ordenarArray();" />
  </p>
  <hr />
  <p id="explica"></p>
  <h2 id="tamano"></h2>

  <br />
  <script language="JavaScript">
    var arrayX = new Array();
    var arraymix = new Array();

    // Función que limpia el array global y la pantalla
    function eliminarArra() {
      arraymix = new Array();
      document.getElementById("explica").innerHTML = "Array eliminado";
      document.getElementById("tamano").innerHTML = "Tamaño: 0";
    }

    function addArrays() {
      arrayXstr = document.getElementsByName("caja1")[0].value;
      arrayX = arrayXstr.split(",");
      arraymix = []; // Importante limpiar antes de añadir
      lX = arrayX.length;
      for (var i = 0; i < lX; i++) {
        arraymix.push(arrayX[i]);
      }
      actualizarPantalla();
    }

    function ordenarArray() {
      arraymix.sort();
      actualizarPantalla();
    }

    // Función auxiliar para no repetir código de mostrar en pantalla
    function actualizarPantalla() {
      contenidostr = "El contenido del array es " + arraymix.join("-");
      tamanostr = "El tamano del array es " + arraymix.length;
      document.getElementById("explica").innerHTML = contenidostr;
      document.getElementById("tamano").innerHTML = tamanostr;
    }

    function addArrayNum() {
      arrayXstr = document.getElementsByName("caja1")[0].value;
      arrayX = arrayXstr.split(",");
      lX = arrayX.length;

      let valor = 0;
      let mayor = Number.MIN_VALUE;
      let menor = Number.MAX_VALUE;
      // Faltaba declarar suma
      let suma = 0;
      let total = 0;
      let arrayOK = [];

      for (var i = 0; i < lX; i++) {
        valor = parseInt(arrayX[i]);
        if (!isNaN(valor)) {
          if (mayor < valor) mayor = valor;
          if (menor > valor) menor = valor;
          suma += valor;
          total += 1;
          arrayOK.push(valor);
        }
      }

      contenidostr = "El contenido correcto del array es " + arrayOK.join("-");
      tamanostr = "<br>El tamano del array es " + arrayOK.length;
      let MaxStr = "<br>El mayor del array es " + mayor;
      let MinStr = "<br>El menor del array es " + menor;
      // Evitar división por cero
      let mediaCalc = total > 0 ? suma / total : 0;
      let MediaStr = "<br>La media es " + mediaCalc;

      document.getElementById("explica").innerHTML = contenidostr + MaxStr + MinStr + MediaStr;
      document.getElementById("tamano").innerHTML = tamanostr;
    }

    function concatenaArrays2() {
      // Limpiamos arraymix para que no se acumule con lo anterior
      arraymix = new Array();

      arrayXstr = document.getElementsByName("caja1")[0].value;
      arrayZstr = document.getElementsByName("caja2")[0].value;
      arrayYstr = document.getElementsByName("caja3")[0].value;

      arrayX = arrayXstr.split(",");
      arrayZ = arrayZstr.split(",");
      arrayY = arrayYstr.split(",");

      lX = arrayX.length;
      lZ = arrayZ.length;
      lY = arrayY.length;
      lmax = Math.max(lX, lZ, lY);

      for (var i = 0; i < lmax; i++) {
        if (arrayX[i] != undefined) arraymix.push(arrayX[i]);
        if (arrayZ[i] != undefined) arraymix.push(arrayZ[i]);
        if (arrayY[i] != undefined) arraymix.push(arrayY[i]);
      }

      actualizarPantalla();
    }

    function concatenaArrays3() {
      // Limpiamos arraymix
      arraymix = new Array();

      arrayXstr = document.getElementsByName("caja1")[0].value;
      arrayZstr = document.getElementsByName("caja2")[0].value;
      arrayYstr = document.getElementsByName("caja3")[0].value;

      arrayX = arrayXstr.split(",");
      arrayZ = arrayZstr.split(",");
      arrayY = arrayYstr.split(",");

      // USO DE CONCAT (Tal y como pedía el comentario)
      // Concat une los arrays uno detrás de otro, no intercalados
      arraymix = arrayX.concat(arrayZ, arrayY);

      actualizarPantalla();
    }
  </script>
</body>

</html>